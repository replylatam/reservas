<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas</title>
    <style>
        /* Estilos básicos */
        body { font-family: Arial, sans-serif; margin: 20px; }
        .chair { width: 30px; height: 30px; display: inline-block; margin: 5px; text-align: center; line-height: 30px; cursor: pointer; }
        .reserved { background-color: red; color: white; }
        .available { background-color: green; color: white; }
        #chairs { margin-bottom: 20px; }
        button { padding: 5px 10px; margin: 5px; }
        .notification { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Reservas</h1>
    <div id="chairs"></div>
    <div>
        <button id="clearAllBtn">Limpiar Todas las Reservas</button>
    </div>
    <div id="notificationContainer"></div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
        import { getDatabase, ref, set, get, onValue } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-database.js";

        document.addEventListener('DOMContentLoaded', () => {
            // --- Configuración Firebase ---
            const firebaseConfig = {
                apiKey: "TU_API_KEY",
                authDomain: "TU_AUTH_DOMAIN",
                databaseURL: "TU_DATABASE_URL",
                projectId: "TU_PROJECT_ID",
                storageBucket: "TU_STORAGE_BUCKET",
                messagingSenderId: "TU_MESSAGING_SENDER_ID",
                appId: "TU_APP_ID"
            };

            const app = initializeApp(firebaseConfig);
            const db = getDatabase(app);
            const reservationsRef = ref(db, 'reservas');

            // --- Variables ---
            let reservations = {};

            const chairsContainer = document.getElementById('chairs');
            const clearAllBtn = document.getElementById('clearAllBtn');
            const notificationContainer = document.getElementById('notificationContainer');

            const totalChairs = 20; // ejemplo de 20 sillas

            // --- Funciones ---
            function showNotification(message, type = 'success') {
                const div = document.createElement('div');
                div.className = `notification ${type}`;
                div.textContent = message;
                notificationContainer.appendChild(div);
                setTimeout(() => div.remove(), 3000);
            }

            function updateChairDisplay() {
                chairsContainer.innerHTML = '';
                for (let i = 1; i <= totalChairs; i++) {
                    const chair = document.createElement('div');
                    chair.className = 'chair';
                    chair.textContent = i;
                    if (reservations[i]) {
                        chair.classList.add('reserved');
                    } else {
                        chair.classList.add('available');
                        chair.addEventListener('click', () => {
                            const name = prompt('Ingresa tu nombre para reservar la silla ' + i);
                            if (name) {
                                reservations[i] = name;
                                saveReservations();
                                updateChairDisplay();
                                showNotification(`Silla ${i} reservada por ${name}`, 'success');
                            }
                        });
                    }
                    chairsContainer.appendChild(chair);
                }
            }

            function saveReservations() {
                set(reservationsRef, reservations)
                    .then(() => console.log('Reservas guardadas correctamente'))
                    .catch(err => showNotification('Error guardando reservas: ' + err, 'error'));
            }

            // --- Escucha en tiempo real ---
            onValue(reservationsRef, (snapshot) => {
                reservations = snapshot.val() || {};
                updateChairDisplay();
            });

            // --- Botón Limpiar Todas las Reservas ---
            clearAllBtn.addEventListener('click', () => {
                const adminUser = prompt("Usuario admin:");
                const adminPass = prompt("Contraseña admin:");

                if (adminUser === 'admin' && adminPass === '1234') { // Cambia usuario y contraseña
                    reservations = {};
                    saveReservations();
                    showNotification('Todas las reservas han sido eliminadas por admin', 'success');
                } else {
                    showNotification('Usuario o contraseña incorrecta. No tienes permisos.', 'error');
                }
            });

            // --- Inicializar ---
            updateChairDisplay();
        });
    </script>
</body>
</html>




